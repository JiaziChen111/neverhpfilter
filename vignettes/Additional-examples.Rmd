---
title: "Additional examples"
author: "Justin M Shea"
date: ' '
output:
  rmarkdown::html_document:
    toc: yes
vignette: >
  %\VignetteIndexEntry{Additional examples}  
  %\VignetteEngine{knitr::rmarkdown}  
  %\VignetteEncoding{UTF-8}
---

## Implementation in R

```{r, message = FALSE, warning = FALSE}
library(xts)
library(knitr)
library(neverhpfilter)
```

The `yth_glm` function returns an object of class "`glm`". Thus, one can use all
generic functions associated with objects of that class. Here is an example of
passing the `yth_glm` model to the plot function.

```{r, warning=FALSE, message=FALSE}
data(GDPC1)
log_RGDP <- 100*log(GDPC1)

gdp_ar <- yth_glm(log_RGDP, h = 8, p = 4)

plot(gdp_ar)
```

In addition to all generic functions inherited in base R, one can also use any package 
designed to work with model objects.

```{r, warning=FALSE, message=FALSE}
library(broom)
gdp_ar_df <- broom::tidy(gdp_ar)

kable(gdp_ar_df)
```

```{r, warning = FALSE, message = FALSE}
gdp_filtered <- yth_filter(log_RGDP, h = 8, p = 4)

kable(tail(gdp_filtered, 8))
```

```{r, warning = FALSE, message = FALSE}
library(PerformanceAnalytics)

  qtr_recc <- to.quarterly(USREC["1947-1/2017-3"], OHLC=FALSE)
     start <- index(qtr_recc[which(diff(qtr_recc$USREC)==1)])
       end <- index(qtr_recc[which(diff(qtr_recc$USREC)==-1)])
Recessions <- paste(format(start,"%Y-%q"), format(end,"%Y-%q"), sep="/")

main <- "Log of Real GDP (GDPC1) and trend"
chart.TimeSeries(gdp_filtered[,1:2], main = main, period.areas = Recessions, period.color="lightgrey", lwd=2)
```

```{r, warning = FALSE}
main <- "Log of Real GDP cycle and random walk"
plot(gdp_filtered[,3:4], subset = "1982/", grid.col = "white", legend.loc = "topright", main = main)
#lines(panel.first = abline(v = .index(qtr_recc2), type="h", lwd = 2, col = "lightgrey"))
#addSeries(x = .index(qtr_recc2), type="h", lwd = 2, col = "lightgrey")

```


```{r, warning = FALSE}
Employment_log <- 100*log(PAYEMS["1947/"])

employ_cycle <- yth_cycle(Employment_log, h = 24, p = 12)

main <- "Absolute Log of Employment cycle"
plot(abs(employ_cycle), index(employ_filtered), col = "Black", grid.col = "white", main = main)
```

